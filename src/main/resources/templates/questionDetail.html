<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" >
<head>
    <meta charset="utf-8">
    <title>404-We-Found</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/login-signup.css}" type="text/css">
</head>
<body>

<header th:replace="~{fragments/header :: header}"></header>

<header>
    <div id="container">
        <h1 th:text="${question.title}"></h1>
        <div th:text="|Posted on ${#temporals.format(question.creatAt, 'yyyy-MM-dd HH:mm')}|"></div>
    </div>
</header>
<section class="mb-5">
    <input type="hidden" id="question-id" th:value="${question.questionId}">
    <p class="fs-5 mb-4" th:text="${question.content}"></p>
    <p>질문 작성자: <span th:text="${user.getNickName()}"></span></p>
</section>
<button type="button" id="modify-btn" th:onclick="|location.href='@{/inputQuestion?questionId={questionId}(questionId=${question.questionId})}'|"
        class="btn btn-primary btn-sm">수정</button>
<button type="button" id="delete-btn" class="btn btn-secondary btn-sm">삭제</button>
<button type="button" id="back-btn" class="btn btn-primary btn-sm">목록으로가기</button>

<!--질문 댓글 리스트-->
<div id="wrapper" th:if="${!comments.isEmpty()}">
    <div class="row-6" th:each="comment : ${comments}">
        <div class="card-body">
            <p class="card-text" th:text="${comment.content}"></p>
        </div>
    </div>
</div>
<!--질문 댓글 입력-->
<div>
    <input placeholder="댓글을 입력하세요" id="comment-content"/>
    <button type="button" id="create-comment-btn" th:data-question-id = "${question.questionId}">댓글 달기</button>
</div>



<div id="answer-wrapper">
    <h3>Answers</h3>
    <ul>
        <li th:each="answer : ${answers}">
            <p th:text="${answer.content}"></p>
            <p th:text="'Posted on ' + ${#temporals.format(answer.createdAt, 'yyyy-MM-dd HH:mm')}"></p>
            <form th:action="@{/api/answers/{answerId}/like(answerId=${answer.answerId})}" method="post">
                <button type="submit">좋아요</button>
                <span th:text="${answer.likedUsers.size()}"></span>
            </form>
            <!--답변 댓글 리스트-->
            <div class="answer-comment-wrapper" th:if="${!answer.comments.isEmpty()}">
                <div class="row-6" th:each="comment : ${answer.comments}">
                    <div class="card-body">
                        <p class="card-text" th:text="${comment.content}"></p>
                    </div>
                </div>
            </div>
            <button th:data-answer-id="${answer.answerId}" class="add-comment-btn">Add Comment</button>
            <div class="comment-form" style="display: none;">
                <textarea class="comment-content" rows="2" required></textarea>
                <button class="submit-comment-btn">Submit</button>
            </div>
        </li>
    </ul>
</div>



<a th:href="@{/api/questions/{questionId}/answers/new(questionId=${question.questionId})}">
    <button>답변달기</button>
</a>

<footer th:replace="~{fragments/footer :: footer}"></footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script src="/scripts/question.js"></script>
<script src="/scripts/comment.js"></script>
<script src="/scripts/answer-comment.js"></script>
</body>
</html>
